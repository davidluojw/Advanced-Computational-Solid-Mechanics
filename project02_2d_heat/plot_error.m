% plot the error
figure;
log_h = [1/20,1/40,1/60,1/80,1/100];
log_h = log(log_h);


% =========================================================================
% deg=1
% log_L2_error = [0.0104234485235174,0.00260747368224121,0.00115900927180217,...
%     0.000651968693441865,0.000417267656262819];
% log_L2_error = log(log_L2_error);
% log_H1_error = [0.0889671276063226,0.0444927896097855,0.0296630678134176,...
%     0.0222476220548446,0.0177982171707395];
% log_H1_error = log(log_H1_error);
% =========================================================================

% =========================================================================
% deg=2
% log_L2_error = [0.000190196507438366,2.38339726771172e-05,7.06518080153333e-06,...
%     2.98110527302875e-06,1.52644020079334e-06];
% log_L2_error = log(log_L2_error);
% log_H1_error = [0.00357733764700319,0.000894617027925906,0.000397630431527223,...
%     0.000223671602854791,0.000143151152674810];
% log_H1_error = log(log_H1_error);
% =========================================================================


% =========================================================================
% deg=3
log_L2_error = [5.82724216539033e-06,3.65264115798362e-07,7.21950816765834e-08,...
    2.28483960131252e-08,9.35983108202773e-09];
log_L2_error = log(log_L2_error);
log_H1_error = [6.36903420425338e-06,4.07220481611997e-07,8.20684240979768e-08,...
    2.64635450144018e-08,1.10377773648279e-08];
log_H1_error = log(log_H1_error);
% =========================================================================


plot(log_h, log_L2_error,'b-', 'LineWidth', 2);
hold on;
plot(log_h, log_H1_error,'r-', 'LineWidth', 2);
xlabel("log-h");
ylabel("log-error");
legend('L2-error', 'H1-error','Location', 'Best', 'FontSize', 14, 'Box', 'on');

% rate of error
L2_rate_error = zeros(length(log_h)-1,1);
H1_rate_error = zeros(length(log_h)-1,1);
for ii = 1:length(log_h)-1
    L2_rate_error(ii) = (log_L2_error(ii+1) - log_L2_error(ii))/(log_h(ii+1)-log_h(ii));
    H1_rate_error(ii) = (log_H1_error(ii+1) - log_H1_error(ii))/(log_h(ii+1)-log_h(ii));
end