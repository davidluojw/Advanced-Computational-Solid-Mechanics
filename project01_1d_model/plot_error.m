% plot the error
figure;
log_h = [1/2,1/4,1/6,1/8,1/10,1/12,1/14];
log_h = log(log_h);

% =========================================================================
% deg=1
% log_L2_error = [0.484506990465074, 0.137310713571363, 0.0624336609000978,...
%     0.0353987795207906, 0.0227384390300609, 0.0158220347007937, 0.0116382998961328];
% log_L2_error = log(log_L2_error);
% log_H1_error = [0.568853012649138, 0.316045318830524, 0.214846242113617,...
%     0.162236770760622, 0.130199291856753, 0.108685343314206, 0.0932550760846382];
% =========================================================================

% =========================================================================
% deg=2
% log_L2_error = [0.0583638844316620,0.00782135960630838,0.00234624976349926,...
%     0.000994076801627725,0.000509975022731040,0.000295441195509620,0.000186170706444686];
% log_L2_error = log(log_L2_error);
% log_H1_error = [0.137500000000000,0.0367187500000000,0.0165123456790128,...
%     0.00932617187499990,0.00597999999999995,0.00415702160493805,0.00305601832569772];
% log_H1_error = log(log_H1_error);
% =========================================================================

% =========================================================================
% deg=3
log_L2_error = [0.00465847495312498,0.000296308264919676,5.87166077345804e-05,...
    1.85989196844788e-05,7.62202322856128e-06,3.67676698432309e-06,1.98496004352310e-06];
log_L2_error = log(log_L2_error);
log_H1_error = [0.0159169159790994,0.00203189378534167,0.000604333958313603,...
    0.000255290856841078,0.000130788815597243,7.57130763469799e-05,4.76889015846964e-05];
log_H1_error = log(log_H1_error);
% =========================================================================



plot(log_h, log_L2_error,'b-', 'LineWidth', 2);
hold on;
plot(log_h, log_H1_error,'r-', 'LineWidth', 2);
xlabel("log-h");
ylabel("log-error");
legend('L2-error', 'H1-error','Location', 'Best', 'FontSize', 14, 'Box', 'on');

% rate of error
L2_rate_error = zeros(length(log_h)-1,1);
H1_rate_error = zeros(length(log_h)-1,1);
for ii = 1:length(log_h)-1
    L2_rate_error(ii) = (log_L2_error(ii+1) - log_L2_error(ii))/(log_h(ii+1)-log_h(ii));
    H1_rate_error(ii) = (log_H1_error(ii+1) - log_H1_error(ii))/(log_h(ii+1)-log_h(ii));
end